<!DOCTYPE html>
<html lang="en">
<head>
        <title>Cloud or not - memcache</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
        <link href=".././feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Cloud or not ATOM Feed" />
        

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie.css"/>
                <script src=".././js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href=".././css/ie6.css"/><![endif]-->

</head>

<body id="index" class="home">

        <header id="banner" class="body">
                <h1><a href="../.">Cloud or not </a></h1>
                <nav><ul>
                
                
                
                
                
                    <li ><a href=".././category/misc.html">misc</a></li>
                
                    <li ><a href=".././category/sql_nosql.html">sql_nosql</a></li>
                
                </ul></nav>
        </header><!-- /#banner -->
                

            

        
        
            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href=".././get-familar-with-redis.html">get familar with redis:a great data structure server</a></h1> 
                    <footer class="post-info">
        <abbr class="published" title="2012-06-15T14:03:34.601488">
                2012/六月/15 星期五
        </abbr>

        
        <address class="vcard author">
                By <a class="url fn" href=".././author/wangweiwei.html">wangweiwei</a>
        </address>
        
<p>In <a href=".././category/sql_nosql.html">sql_nosql</a>. </p>
<p>tags: <a href=".././tag/redis.html">redis</a><a href=".././tag/nosql.html">nosql</a><a href=".././tag/memcache.html">memcache</a></p>


</footer><!-- /.post-info --><h1>intro</h1>
<p>redis是一个基于内存的数据结构database，相对于memcache，它提供了更为丰富的数据结构:string,hash,list,set,sorted set，同时它还提供了持久化能力，master-slave数据备份。同时在速度上与memcache也不相上下:<a href="http://antirez.com/post/redis-memcached-benchmark.html">redis-memcached-benchmark</a>,有同学质疑这个给出了个相反的<a href="http://dormando.livejournal.com/525147.html">benchmark</a>，当然redis作者antirez又给出了一个<a href="http://antirez.com/post/update-on-memcached-redis-benchmark.html">新的评测</a>,不想仔细看英文的同学我大概总结一下，redis和memcached在同样的硬件配置下并且都是单线程的情况下吞吐也是相当的，100k每秒是问题不大的，大家可以follow这几篇文章自测一下。我很懒，没有对这个做过测试。</p>
<p>使用redis你可以做很多事情:</p>
<ol>
<li>做一个k-v系统用，不过这个k-v系统没有mongodb强大，不支持value查询，只能简单的get/set。</li>
<li>做一个任务优先队列使用，list结构支持这样的各种api</li>
<li>做一个消息队列使用，redis提供pub/sub这样的api来提供消息队列服务。</li>
<li>数据统计，实时计数服务。微博上的各种数字都可以用这个服务来实时计数。</li>
<li>做类似与memcached的内存cache，还可以持久化，性能也超级赞～</li>
</ol>
<h1>install</h1>
<ul>
<li>下载最新的redis版本<a href="http://redis.io/download" title="redis-download">redis download page</a></li>
<li>
<p>加上你下载到/tmp目录下了，解压编译安装</p>
<div class="codehilite"><pre><span class="n">tar</span> <span class="n">xvf</span> <span class="n">redis</span><span class="o">-</span>2<span class="p">.</span>4<span class="p">.</span>14<span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">gz</span>
<span class="n">cd</span> <span class="n">redis</span><span class="o">-</span>2<span class="p">.</span>4<span class="p">.</span>14
<span class="n">make</span>
<span class="n">sudo</span> <span class="n">make</span> <span class="n">PREFIX</span><span class="p">=</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span> <span class="n">install</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">etc</span>
<span class="n">sudo</span> <span class="n">cp</span> <span class="n">redis</span><span class="p">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">etc</span>
<span class="n">sudo</span> <span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="p">{</span><span class="n">db</span><span class="p">,</span><span class="n">run</span><span class="p">,</span><span class="nb">log</span><span class="p">}</span>
<span class="n">sudo</span> <span class="n">vim</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">redis</span><span class="p">.</span><span class="n">conf</span> 根据目录结构做相应修改，主要修改的就是包含<span class="o">/</span><span class="n">var</span>路径的几行
</pre></div>


<ul>
<li>
<p>启动服务</p>
<p>sudo bin/redis-server etc/redis.conf</p>
</li>
</ul>
</li>
</ul>
<h1>test</h1>
<div class="codehilite"><pre><span class="n">cd</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span>
<span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">cli</span>
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">set</span> <span class="n">test</span> 1
<span class="n">OK</span>
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">get</span> <span class="n">test</span>
&quot;1&quot;
</pre></div>


<h1>benchmark</h1>
<h2>系统配置</h2>
<ul>
<li>Linux pc 2.6.38-15-generic #60-Ubuntu SMP Tue May 22 11:30:47 UTC 2012 i686 i686 i386 GNU/Linux</li>
<li>Intel(R) Core(TM) i7-2620M CPU @ 2.70GHz</li>
<li>4G memeory</li>
</ul>
<h2>使用的命令</h2>
<div class="codehilite"><pre><span class="n">Usage</span><span class="o">:</span> <span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">[-</span><span class="n">h</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;]</span> <span class="o">[-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;]</span> <span class="o">[-</span><span class="n">c</span> <span class="o">&lt;</span><span class="n">clients</span><span class="o">&gt;]</span> <span class="o">[-</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">requests</span><span class="o">]&gt;</span> <span class="o">[-</span><span class="n">k</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;]</span>
 <span class="o">-</span><span class="n">h</span> <span class="o">&lt;</span><span class="n">hostname</span><span class="o">&gt;</span>      <span class="n">Server</span> <span class="n">hostname</span> <span class="o">(</span><span class="k">default</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">)</span>
 <span class="o">-</span><span class="n">p</span> <span class="o">&lt;</span><span class="n">port</span><span class="o">&gt;</span>          <span class="n">Server</span> <span class="n">port</span> <span class="o">(</span><span class="k">default</span> <span class="mi">6379</span><span class="o">)</span>
 <span class="o">-</span><span class="n">s</span> <span class="o">&lt;</span><span class="n">socket</span><span class="o">&gt;</span>        <span class="n">Server</span> <span class="n">socket</span> <span class="o">(</span><span class="n">overrides</span> <span class="n">host</span> <span class="n">and</span> <span class="n">port</span><span class="o">)</span>
 <span class="o">-</span><span class="n">c</span> <span class="o">&lt;</span><span class="n">clients</span><span class="o">&gt;</span>       <span class="n">Number</span> <span class="n">of</span> <span class="n">parallel</span> <span class="n">connections</span> <span class="o">(</span><span class="k">default</span> <span class="mi">50</span><span class="o">)</span>
 <span class="o">-</span><span class="n">n</span> <span class="o">&lt;</span><span class="n">requests</span><span class="o">&gt;</span>      <span class="n">Total</span> <span class="n">number</span> <span class="n">of</span> <span class="n">requests</span> <span class="o">(</span><span class="k">default</span> <span class="mi">10000</span><span class="o">)</span>
 <span class="o">-</span><span class="n">d</span> <span class="o">&lt;</span><span class="n">size</span><span class="o">&gt;</span>          <span class="n">Data</span> <span class="n">size</span> <span class="n">of</span> <span class="n">SET</span><span class="o">/</span><span class="n">GET</span> <span class="n">value</span> <span class="k">in</span> <span class="n">bytes</span> <span class="o">(</span><span class="k">default</span> <span class="mi">2</span><span class="o">)</span>
 <span class="o">-</span><span class="n">k</span> <span class="o">&lt;</span><span class="n">boolean</span><span class="o">&gt;</span>       <span class="mi">1</span><span class="o">=</span><span class="n">keep</span> <span class="n">alive</span> <span class="mi">0</span><span class="o">=</span><span class="n">reconnect</span> <span class="o">(</span><span class="k">default</span> <span class="mi">1</span><span class="o">)</span>
 <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">keyspacelen</span><span class="o">&gt;</span>   <span class="n">Use</span> <span class="n">random</span> <span class="n">keys</span> <span class="k">for</span> <span class="n">SET</span><span class="sr">/GET/</span><span class="n">INCR</span><span class="o">,</span> <span class="n">random</span> <span class="n">values</span> <span class="k">for</span> <span class="n">SADD</span>
  <span class="n">Using</span> <span class="k">this</span> <span class="n">option</span> <span class="n">the</span> <span class="n">benchmark</span> <span class="n">will</span> <span class="kd">get</span><span class="o">/</span><span class="kd">set</span> <span class="n">keys</span>
  <span class="k">in</span> <span class="n">the</span> <span class="n">form</span> <span class="n">mykey_rand</span><span class="o">:</span><span class="mi">000000012456</span> <span class="n">instead</span> <span class="n">of</span> <span class="n">constant</span>
  <span class="n">keys</span><span class="o">,</span> <span class="n">the</span> <span class="o">&lt;</span><span class="n">keyspacelen</span><span class="o">&gt;</span> <span class="n">argument</span> <span class="n">determines</span> <span class="n">the</span> <span class="n">max</span>
  <span class="n">number</span> <span class="n">of</span> <span class="n">values</span> <span class="k">for</span> <span class="n">the</span> <span class="n">random</span> <span class="n">number</span><span class="o">.</span> <span class="n">For</span> <span class="n">instance</span>
  <span class="k">if</span> <span class="kd">set</span> <span class="n">to</span> <span class="mi">10</span> <span class="n">only</span> <span class="n">rand</span><span class="o">:</span><span class="mi">000000000000</span> <span class="o">-</span> <span class="n">rand</span><span class="o">:</span><span class="mi">000000000009</span>
  <span class="n">range</span> <span class="n">will</span> <span class="n">be</span> <span class="n">allowed</span><span class="o">.</span>
 <span class="o">-</span><span class="n">P</span> <span class="o">&lt;</span><span class="n">numreq</span><span class="o">&gt;</span>        <span class="n">Pipeline</span> <span class="o">&lt;</span><span class="n">numreq</span><span class="o">&gt;</span> <span class="n">requests</span><span class="o">.</span> <span class="n">Default</span> <span class="mi">1</span> <span class="o">(</span><span class="n">no</span> <span class="n">pipeline</span><span class="o">).</span>
 <span class="o">-</span><span class="n">q</span>                 <span class="n">Quiet</span><span class="o">.</span> <span class="n">Just</span> <span class="n">show</span> <span class="n">query</span><span class="o">/</span><span class="n">sec</span> <span class="n">values</span>
 <span class="o">--</span><span class="n">csv</span>              <span class="n">Output</span> <span class="k">in</span> <span class="n">CSV</span> <span class="n">format</span>
 <span class="o">-</span><span class="n">l</span>                 <span class="n">Loop</span><span class="o">.</span> <span class="n">Run</span> <span class="n">the</span> <span class="n">tests</span> <span class="n">forever</span>
 <span class="o">-</span><span class="n">t</span> <span class="o">&lt;</span><span class="n">tests</span><span class="o">&gt;</span>         <span class="n">Only</span> <span class="n">run</span> <span class="n">the</span> <span class="n">comma</span> <span class="n">separated</span> <span class="n">list</span> <span class="n">of</span> <span class="n">tests</span><span class="o">.</span> <span class="n">The</span> <span class="n">test</span>
                <span class="n">names</span> <span class="n">are</span> <span class="n">the</span> <span class="n">same</span> <span class="k">as</span> <span class="n">the</span> <span class="n">ones</span> <span class="n">produced</span> <span class="k">as</span> <span class="n">output</span><span class="o">.</span>
 <span class="o">-</span><span class="n">I</span>                 <span class="n">Idle</span> <span class="n">mode</span><span class="o">.</span> <span class="n">Just</span> <span class="n">open</span> <span class="n">N</span> <span class="n">idle</span> <span class="n">connections</span> <span class="n">and</span> <span class="n">wait</span><span class="o">.</span>

<span class="n">Examples</span><span class="o">:</span>

 <span class="n">Run</span> <span class="n">the</span> <span class="n">benchmark</span> <span class="k">with</span> <span class="n">the</span> <span class="k">default</span> <span class="n">configuration</span> <span class="n">against</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">6379</span><span class="o">:</span>
   <span class="n">$</span> <span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span>

 <span class="n">Use</span> <span class="mi">20</span> <span class="n">parallel</span> <span class="n">clients</span><span class="o">,</span> <span class="k">for</span> <span class="n">a</span> <span class="n">total</span> <span class="n">of</span> <span class="mi">100</span><span class="n">k</span> <span class="n">requests</span><span class="o">,</span> <span class="n">against</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span><span class="o">:</span>
   <span class="n">$</span> <span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">h</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">1.1</span> <span class="o">-</span><span class="n">p</span> <span class="mi">6379</span> <span class="o">-</span><span class="n">n</span> <span class="mi">100000</span> <span class="o">-</span><span class="n">c</span> <span class="mi">20</span>

 <span class="n">Fill</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">6379</span> <span class="k">with</span> <span class="n">about</span> <span class="mi">1</span> <span class="n">million</span> <span class="n">keys</span> <span class="n">only</span> <span class="n">using</span> <span class="n">the</span> <span class="n">SET</span> <span class="n">test</span><span class="o">:</span>
   <span class="n">$</span> <span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">t</span> <span class="kd">set</span> <span class="o">-</span><span class="n">n</span> <span class="mi">1000000</span> <span class="o">-</span><span class="n">r</span> <span class="mi">100000000</span>

 <span class="n">Benchmark</span> <span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">:</span><span class="mi">6379</span> <span class="k">for</span> <span class="n">a</span> <span class="n">few</span> <span class="n">commands</span> <span class="n">producing</span> <span class="n">CSV</span> <span class="n">output</span><span class="o">:</span>
   <span class="n">$</span> <span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">t</span> <span class="n">ping</span><span class="o">,</span><span class="kd">set</span><span class="o">,</span><span class="kd">get</span> <span class="o">-</span><span class="n">n</span> <span class="mi">100000</span> <span class="o">--</span><span class="n">csv</span>

 <span class="n">Fill</span> <span class="n">a</span> <span class="n">list</span> <span class="k">with</span> <span class="mi">10000</span> <span class="n">random</span> <span class="n">elements</span><span class="o">:</span>
   <span class="n">$</span> <span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">r</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10000</span> <span class="n">lpush</span> <span class="n">mylist</span> <span class="n">ele</span><span class="o">:</span><span class="n">rand</span><span class="o">:</span><span class="mi">000000000000</span>
</pre></div>


<h2>测试结果</h2>
<h3>value size 32</h3>
<div class="codehilite"><pre><span class="n">wangweiwei</span><span class="p">@</span><span class="n">pc</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span>$ <span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">n</span> 100000 <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">r</span> 10000 <span class="o">-</span><span class="n">d</span> 32
<span class="n">PING_INLINE</span><span class="p">:</span> 133333<span class="p">.</span>33 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">PING_BULK</span><span class="p">:</span> 135135<span class="p">.</span>14 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SET</span><span class="p">:</span> 123001<span class="p">.</span>23 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">GET</span><span class="p">:</span> 105374<span class="p">.</span>08 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">INCR</span><span class="p">:</span> 115874<span class="p">.</span>85 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span><span class="p">:</span> 121802<span class="p">.</span>68 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPOP</span><span class="p">:</span> 119474<span class="p">.</span>31 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SADD</span><span class="p">:</span> 125313<span class="p">.</span>28 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SPOP</span><span class="p">:</span> 129533<span class="p">.</span>68 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span> <span class="p">(</span><span class="n">needed</span> <span class="n">to</span> <span class="n">benchmark</span> <span class="n">LRANGE</span><span class="p">):</span> 114942<span class="p">.</span>53 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_100</span> <span class="p">(</span><span class="n">first</span> 100 <span class="n">elements</span><span class="p">):</span> 43936<span class="p">.</span>73 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_300</span> <span class="p">(</span><span class="n">first</span> 300 <span class="n">elements</span><span class="p">):</span> 11580<span class="p">.</span>78 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_500</span> <span class="p">(</span><span class="n">first</span> 450 <span class="n">elements</span><span class="p">):</span> 4827<span class="p">.</span>42 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_600</span> <span class="p">(</span><span class="n">first</span> 600 <span class="n">elements</span><span class="p">):</span> 4644<span class="p">.</span>03 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">MSET</span> <span class="p">(</span>10 <span class="n">keys</span><span class="p">):</span> 48146<span class="p">.</span>36 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
</pre></div>


<h3>value size 128</h3>
<div class="codehilite"><pre><span class="n">wangweiwei</span><span class="p">@</span><span class="n">pc</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span>$ <span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">n</span> 100000 <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">r</span> 10000 <span class="o">-</span><span class="n">d</span> 128
<span class="n">PING_INLINE</span><span class="p">:</span> 125000<span class="p">.</span>00 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">PING_BULK</span><span class="p">:</span> 124843<span class="p">.</span>95 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SET</span><span class="p">:</span> 116822<span class="p">.</span>43 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">GET</span><span class="p">:</span> 117785<span class="p">.</span>63 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">INCR</span><span class="p">:</span> 122249<span class="p">.</span>39 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span><span class="p">:</span> 132978<span class="p">.</span>72 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPOP</span><span class="p">:</span> 128534<span class="p">.</span>70 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SADD</span><span class="p">:</span> 117647<span class="p">.</span>06 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SPOP</span><span class="p">:</span> 125000<span class="p">.</span>00 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span> <span class="p">(</span><span class="n">needed</span> <span class="n">to</span> <span class="n">benchmark</span> <span class="n">LRANGE</span><span class="p">):</span> 123915<span class="p">.</span>73 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_100</span> <span class="p">(</span><span class="n">first</span> 100 <span class="n">elements</span><span class="p">):</span> 24770<span class="p">.</span>87 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_300</span> <span class="p">(</span><span class="n">first</span> 300 <span class="n">elements</span><span class="p">):</span> 7216<span class="p">.</span>05 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_500</span> <span class="p">(</span><span class="n">first</span> 450 <span class="n">elements</span><span class="p">):</span> 4908<span class="p">.</span>70 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_600</span> <span class="p">(</span><span class="n">first</span> 600 <span class="n">elements</span><span class="p">):</span> 3758<span class="p">.</span>97 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">MSET</span> <span class="p">(</span>10 <span class="n">keys</span><span class="p">):</span> 45207<span class="p">.</span>96 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
</pre></div>


<h3>value size 512</h3>
<div class="codehilite"><pre><span class="n">Pngweiwei</span><span class="p">@</span><span class="n">pc</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span>$ <span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">n</span> 100000 <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">r</span> 10000 <span class="o">-</span><span class="n">d</span> 512
<span class="n">ING_INLINE</span><span class="p">:</span> 134589<span class="p">.</span>50 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">PING_BULK</span><span class="p">:</span> 135685<span class="p">.</span>20 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SET</span><span class="p">:</span> 110987<span class="p">.</span>79 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">GET</span><span class="p">:</span> 109051<span class="p">.</span>26 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">INCR</span><span class="p">:</span> 120336<span class="p">.</span>95 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span><span class="p">:</span> 126582<span class="p">.</span>28 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPOP</span><span class="p">:</span> 125628<span class="p">.</span>14 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SADD</span><span class="p">:</span> 100704<span class="p">.</span>94 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SPOP</span><span class="p">:</span> 134228<span class="p">.</span>19 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span> <span class="p">(</span><span class="n">needed</span> <span class="n">to</span> <span class="n">benchmark</span> <span class="n">LRANGE</span><span class="p">):</span> 131233<span class="p">.</span>59 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_100</span> <span class="p">(</span><span class="n">first</span> 100 <span class="n">elements</span><span class="p">):</span> 10895<span class="p">.</span>62 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_300</span> <span class="p">(</span><span class="n">first</span> 300 <span class="n">elements</span><span class="p">):</span> 3354<span class="p">.</span>02 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_500</span> <span class="p">(</span><span class="n">first</span> 450 <span class="n">elements</span><span class="p">):</span> 2206<span class="p">.</span>68 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_600</span> <span class="p">(</span><span class="n">first</span> 600 <span class="n">elements</span><span class="p">):</span> 1614<span class="p">.</span>31 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">MSET</span> <span class="p">(</span>10 <span class="n">keys</span><span class="p">):</span> 37750<span class="p">.</span>09 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
</pre></div>


<h3>value size 2048</h3>
<div class="codehilite"><pre><span class="n">wangweiwei</span><span class="p">@</span><span class="n">pc</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span>$ <span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">n</span> 100000 <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">r</span> 10000 <span class="o">-</span><span class="n">d</span> 2048
<span class="n">PING_INLINE</span><span class="p">:</span> 130548<span class="p">.</span>30 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">PING_BULK</span><span class="p">:</span> 133511<span class="p">.</span>34 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SET</span><span class="p">:</span> 115340<span class="p">.</span>25 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">GET</span><span class="p">:</span> 112994<span class="p">.</span>35 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">INCR</span><span class="p">:</span> 122699<span class="p">.</span>38 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span><span class="p">:</span> 118343<span class="p">.</span>20 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPOP</span><span class="p">:</span> 93720<span class="p">.</span>71 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SADD</span><span class="p">:</span> 123456<span class="p">.</span>79 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SPOP</span><span class="p">:</span> 116009<span class="p">.</span>28 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span> <span class="p">(</span><span class="n">needed</span> <span class="n">to</span> <span class="n">benchmark</span> <span class="n">LRANGE</span><span class="p">):</span> 103519<span class="p">.</span>67 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_100</span> <span class="p">(</span><span class="n">first</span> 100 <span class="n">elements</span><span class="p">):</span> 3332<span class="p">.</span>22 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_300</span> <span class="p">(</span><span class="n">first</span> 300 <span class="n">elements</span><span class="p">):</span> 1011<span class="p">.</span>06 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_500</span> <span class="p">(</span><span class="n">first</span> 450 <span class="n">elements</span><span class="p">):</span> 635<span class="p">.</span>90 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_600</span> <span class="p">(</span><span class="n">first</span> 600 <span class="n">elements</span><span class="p">):</span> 432<span class="p">.</span>38 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">MSET</span> <span class="p">(</span>10 <span class="n">keys</span><span class="p">):</span> 24021<span class="p">.</span>14 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
</pre></div>


<h3>value size 2048 with pipeline 4 and 20 clients(default 50 clients)</h3>
<div class="codehilite"><pre><span class="n">wangweiwei</span><span class="p">@</span><span class="n">pc</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span>$ <span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span> <span class="o">-</span><span class="n">n</span> 100000 <span class="o">-</span><span class="n">q</span> <span class="o">-</span><span class="n">r</span> 10000 <span class="o">-</span><span class="n">d</span> 2048 <span class="o">-</span><span class="n">c</span> 20 <span class="o">-</span><span class="n">P</span> 4
<span class="n">PING_INLINE</span><span class="p">:</span> 343642<span class="p">.</span>62 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">PING_BULK</span><span class="p">:</span> 395256<span class="p">.</span>91 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SET</span><span class="p">:</span> 156006<span class="p">.</span>23 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">GET</span><span class="p">:</span> 152671<span class="p">.</span>75 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">INCR</span><span class="p">:</span> 216919<span class="p">.</span>73 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span><span class="p">:</span> 163132<span class="p">.</span>14 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPOP</span><span class="p">:</span> 183150<span class="p">.</span>19 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SADD</span><span class="p">:</span> 238663<span class="p">.</span>48 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">SPOP</span><span class="p">:</span> 302114<span class="p">.</span>81 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LPUSH</span> <span class="p">(</span><span class="n">needed</span> <span class="n">to</span> <span class="n">benchmark</span> <span class="n">LRANGE</span><span class="p">):</span> 168634<span class="p">.</span>06 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_100</span> <span class="p">(</span><span class="n">first</span> 100 <span class="n">elements</span><span class="p">):</span> 3061<span class="p">.</span>66 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_300</span> <span class="p">(</span><span class="n">first</span> 300 <span class="n">elements</span><span class="p">):</span> 947<span class="p">.</span>69 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_500</span> <span class="p">(</span><span class="n">first</span> 450 <span class="n">elements</span><span class="p">):</span> 613<span class="p">.</span>75 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">LRANGE_600</span> <span class="p">(</span><span class="n">first</span> 600 <span class="n">elements</span><span class="p">):</span> 436<span class="p">.</span>58 <span class="n">requests</span> <span class="n">per</span> <span class="n">second</span>
<span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span><span class="p">:</span> <span class="n">redis</span><span class="o">-</span><span class="n">benchmark</span><span class="p">.</span><span class="n">c</span><span class="p">:</span>278<span class="p">:</span> <span class="n">createClient</span><span class="p">:</span> <span class="n">Assertion</span> `<span class="n">c</span><span class="o">-&gt;</span><span class="n">randlen</span> <span class="o">&lt;</span> <span class="p">(</span><span class="n">signed</span><span class="p">)(</span><span class="n">sizeof</span><span class="p">(</span><span class="n">c</span><span class="o">-&gt;</span><span class="n">randptr</span><span class="p">)</span><span class="o">/</span><span class="n">sizeof</span><span class="p">(</span><span class="n">char</span><span class="o">*</span><span class="p">))</span><span class="o">&#39;</span> <span class="n">failed</span><span class="p">.</span>
<span class="n">Aborted</span>
</pre></div>


<h1>use case</h1>
<h2>cache系统</h2>
<div class="codehilite"><pre><span class="n">wangweiwei</span><span class="p">@</span><span class="n">pc</span><span class="p">:</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">redis</span>$ <span class="n">bin</span><span class="o">/</span><span class="n">redis</span><span class="o">-</span><span class="n">cli</span> 
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">set</span> <span class="n">test</span> 1
<span class="n">OK</span>
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">get</span> <span class="n">test</span>
&quot;1&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">EXPIRE</span> <span class="n">test</span> 1
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">get</span> <span class="n">test</span>
<span class="p">(</span><span class="n">nil</span><span class="p">)</span>
</pre></div>


<h2>任务队列</h2>
<ul>
<li>
<p>terminal 1</p>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">blpop</span> <span class="n">test</span> 0
1<span class="p">)</span> &quot;<span class="n">test</span>&quot;
2<span class="p">)</span> &quot;1&quot;
<span class="p">(</span>7<span class="p">.</span>54<span class="n">s</span><span class="p">)</span>
</pre></div>


</li>
<li>
<p>terminal 2</p>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">lpush</span> <span class="n">test</span> 1
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
</pre></div>


</li>
</ul>
<h2>消息队列</h2>
<ul>
<li>
<p>terminal 1</p>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SUBSCRIBE</span> <span class="n">test_channel</span>
<span class="n">Reading</span> <span class="n">messages</span><span class="p">...</span> <span class="p">(</span><span class="n">press</span> <span class="n">Ctrl</span><span class="o">-</span><span class="n">C</span> <span class="n">to</span> <span class="n">quit</span><span class="p">)</span>
1<span class="p">)</span> &quot;<span class="n">subscribe</span>&quot;
2<span class="p">)</span> &quot;<span class="n">test_channel</span>&quot;
3<span class="p">)</span> <span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
1<span class="p">)</span> &quot;<span class="n">message</span>&quot;
2<span class="p">)</span> &quot;<span class="n">test_channel</span>&quot;
3<span class="p">)</span> &quot;<span class="n">hello</span>&quot;
1<span class="p">)</span> &quot;<span class="n">message</span>&quot;
2<span class="p">)</span> &quot;<span class="n">test_channel</span>&quot;
3<span class="p">)</span> &quot;<span class="n">let</span><span class="o">&#39;</span><span class="n">s</span> <span class="n">hang</span> <span class="n">out</span> <span class="n">today</span>?&quot;
</pre></div>


</li>
<li>
<p>terminal 2</p>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">PUBLISH</span> <span class="n">test_channel</span> <span class="s">&#39;hello&#39;</span>
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">PUBLISH</span> <span class="n">test_channel</span> <span class="s">&#39;let&#39;</span><span class="n">s</span> <span class="n">hang</span> <span class="n">out</span> <span class="n">today</span>?<span class="s">&#39;</span>
<span class="s">Invalid argument(s)</span>
<span class="s">redis 127.0.0.1:6379&gt; PUBLISH test_channel &#39;</span><span class="n">let</span><span class="o">\</span><span class="s">&#39;s hang out today?&#39;</span>
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
</pre></div>


</li>
</ul>
<h2>实时计数</h2>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">set</span> <span class="n">test</span> 1
<span class="n">OK</span>
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">INCR</span> <span class="n">test</span>
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 2
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">get</span> <span class="n">test</span>
&quot;2&quot;
</pre></div>


<h2>map使用</h2>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">hset</span> <span class="n">test</span> <span class="n">f1</span> <span class="s">&#39;1&#39;</span>
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">HGETALL</span> <span class="n">test</span>
1<span class="p">)</span> &quot;<span class="n">f1</span>&quot;
2<span class="p">)</span> &quot;1&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">HMSET</span> <span class="n">test</span> <span class="n">f2</span> <span class="s">&#39;2&#39;</span> <span class="n">f3</span> <span class="s">&#39;3&#39;</span>
<span class="n">OK</span>
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">HGETALL</span> <span class="n">test</span>
1<span class="p">)</span> &quot;<span class="n">f1</span>&quot;
2<span class="p">)</span> &quot;1&quot;
3<span class="p">)</span> &quot;<span class="n">f2</span>&quot;
4<span class="p">)</span> &quot;2&quot;
5<span class="p">)</span> &quot;<span class="n">f3</span>&quot;
6<span class="p">)</span> &quot;3&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">HMGET</span> <span class="n">test</span> <span class="n">f1</span><span class="p">,</span><span class="n">f2</span>
1<span class="p">)</span> <span class="p">(</span><span class="n">nil</span><span class="p">)</span>
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">HMGET</span> <span class="n">test</span> <span class="n">f1</span> <span class="n">f2</span>
1<span class="p">)</span> &quot;1&quot;
2<span class="p">)</span> &quot;2&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">HMGET</span> <span class="n">test</span> <span class="n">f1</span> <span class="n">f2</span> <span class="n">f4</span>
1<span class="p">)</span> &quot;1&quot;
2<span class="p">)</span> &quot;2&quot;
3<span class="p">)</span> <span class="p">(</span><span class="n">nil</span><span class="p">)</span>
</pre></div>


<h2>set使用</h2>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SADD</span> <span class="n">test</span> 1 2
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 2
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SMEMBERS</span> <span class="n">test</span>
1<span class="p">)</span> &quot;1&quot;
2<span class="p">)</span> &quot;2&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">sadd</span> <span class="n">test1</span> 2 3
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 2
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SMEMBERS</span> <span class="n">test1</span>
1<span class="p">)</span> &quot;2&quot;
2<span class="p">)</span> &quot;3&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SDIFF</span> <span class="n">test</span> <span class="n">test1</span>
1<span class="p">)</span> &quot;1&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SINTER</span> <span class="n">test</span> <span class="n">test1</span>
1<span class="p">)</span> &quot;2&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SUNION</span> <span class="n">test</span> <span class="n">test1</span>
1<span class="p">)</span> &quot;1&quot;
2<span class="p">)</span> &quot;2&quot;
3<span class="p">)</span> &quot;3&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SISMEMBER</span> <span class="n">test</span> 1
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SREM</span> <span class="n">test</span> 1
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 1
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">SMEMBERS</span> <span class="n">test</span>
1<span class="p">)</span> &quot;2&quot;
</pre></div>


<h2>sorted set使用</h2>
<div class="codehilite"><pre><span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">ZADD</span> <span class="n">test</span> 3 1 2 2 1 3
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 3
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">ZRANGE</span> <span class="n">test</span> 0 <span class="o">-</span>1
1<span class="p">)</span> &quot;3&quot;
2<span class="p">)</span> &quot;2&quot;
3<span class="p">)</span> &quot;1&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">ZREVRANGE</span> <span class="n">test</span> 0 <span class="o">-</span>1
1<span class="p">)</span> &quot;1&quot;
2<span class="p">)</span> &quot;2&quot;
3<span class="p">)</span> &quot;3&quot;
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">ZADD</span> <span class="n">test1</span> 1 1 2 2
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 2
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">ZINTERSTORE</span> <span class="n">out</span> 2 <span class="n">test</span> <span class="n">test1</span> 
<span class="p">(</span><span class="n">integer</span><span class="p">)</span> 2
<span class="n">redis</span> 127<span class="p">.</span>0<span class="p">.</span>0<span class="p">.</span>1<span class="p">:</span>6379<span class="o">&gt;</span> <span class="n">ZRANGE</span> <span class="n">out</span> 0 <span class="o">-</span>1 <span class="n">WITHSCORES</span>
1<span class="p">)</span> &quot;1&quot;
2<span class="p">)</span> &quot;4&quot;
3<span class="p">)</span> &quot;2&quot;
4<span class="p">)</span> &quot;4&quot;
</pre></div>


<h1>lib</h1>
<p>请参考官方网站的<a href="http://redis.io/clients">redis client</a></p>
<p>我用的是java版的client:jedis,这个client支持多机hash，连接池等，但是封装的不够好，使用的适合需要自己封装一层负责连接的申请和释放。</p>
<h1>ebook</h1>
<p><a href="../static/upload/redis.pdf">redis cookbook</a></p>
<h1>reference</h1>
<ol>
<li><a href="http://antirez.com/">redis author's blog</a></li>
<li><a href="http://blog.nosqlfan.com">nosqlfan.com</a></li>
</ol><p>There are <a href=".././get-familar-with-redis.html#disqus_thread">comments</a>.</p>
                </article>
                
                    
<p class="paginator">
    
    Page 1 / 1
    
</p>

                
            </aside><!-- /#featured -->
            
        
        
        

    


        <section id="extras" class="body">
        
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                        
                            <li><a href="http://xieyu.github.com">Xieyu</a></li>
                        
                            <li><a href="http://mindhacks.cn">刘未鹏</a></li>
                        
                        </ul>
                </div><!-- /.blogroll -->
        
        
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href=".././feeds/all.atom.xml" rel="alternate">atom feed</a></li>
                            

                        
                            <li><a href="http://weibo.com/lolorosa">新浪微博</a></li>
                        
                        </ul>
                </div><!-- /.social -->
        
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>, which takes great advantages of <a href="http://python.org">python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->


    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-7072537-7");
    pageTracker._trackPageview();
    } catch(err) {}</script>



<script type="text/javascript">
    var disqus_shortname = 'cloudornot';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>